<!DOCTYPE html>
<html lang="en">
<head>

	<!-- SITE TITTLE -->
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Web Builder Template</title>

	<!-- PLUGINS CSS STYLE -->
	<link href="plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet">
	<link href="plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="plugins/selectbox/select_option1.css" rel="stylesheet">
	<link href="plugins/slick/slick.css" rel="stylesheet" media="screen">
	<link href="plugins/slick/slick-theme.css" rel="stylesheet" media="screen">
	<link href="plugins/prismjs/prism.css" rel="stylesheet">
	<link rel="stylesheet" href="plugins/fancybox/jquery.fancybox.min.css" />
	<link href="plugins/selectbox/select_option1.css" rel="stylesheet">
	<link href="plugins/thin-line-icons/css/thin-line-icons.css" rel="stylesheet">
	<link href="plugins/isotope/isotope.min.css" rel="stylesheet">
	<link href="plugins/animate.css" rel="stylesheet">
	<link href="plugins/datepicker/datepicker.min.css" rel="stylesheet">


	<!-- GOOGLE FONT -->

	<!-- CUSTOM CSS -->
	<link href="css/style.css" rel="stylesheet">


	<!-- FAVICON -->
	<link href="img/favicon.png" rel="shortcut icon">

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

</head>

<body id="body" class="page-project-details boxed-menu">
	<div class="mobile-sticky-header-overlay"></div>
	<!-- TOPBAR -->
	<!-- <div class="topbar">
		<div class="container">
			<div class="row">
				<div class="col-sm-9">
					<div class="topbar-content">
						<i class="fa fa-phone" aria-hidden="true"></i>
						<a href="tel:+62 22 20525693">+62 22 20525693</a>
					</div>
					<div class="topbar-content">
						<i class="fa fa-envelope" aria-hidden="true"></i>
						<a href="mailto:info@example.com ">info@example.com</a>
					</div>
					<div class="topbar-content">
						<i class="fa fa-map-marker" aria-hidden="true"></i>
						<p>Bandung, Indonesia</p>
					</div>
				</div>
			</div>
		</div>
	</div> --><!-- TOPBAR ENDS-->
	<!-- HEADER -->
	<!--header id="pageTop" class="header"-->
	<!-- NAVBAR -->
	<header>
		<div class="navbar navbar-toggleable-sm main-nav bg-dark-navy" style="max-width: 100%">
			<nav class="container qw-section" id="nav-container">
				<button class="navbar-toggler navbar-toggler-right">
					<span class="burger-menu icon-toggle"><i class="fa fa-bars"></i></span>
				</button>
				<a class="navbar-brand" href="index.html"><img src="img/logo.png" alt="logo"></a>

				<div class="navbar-collapse">
					<ul class="navbar-nav ml-auto qw-list-item">
						<li class="nav-item">
							<a class="nav-link" href="index.html"><span class="sr-only">(current)</span>Home</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="profile.html"><span class="sr-only"></span>Profile</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="contact.html"><span class="sr-only"></span>Contact</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="product.html"><span class="sr-only"></span>Product</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="gallery.html"><span class="sr-only"></span>Gallery</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="bonus.html"><span class="sr-only"></span>Bonus</a>
						</li>
						<li class="nav-item qw-list-default">
							<a class="nav-link" href="gallery.html"><span class="sr-only"></span>Default</a>
						</li>
						<li class="nav-item dropdown drop_single ">
							<a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" href="javascript:void(0)" data-account>Account <b class="caret"></b></a>
							<ul class="dropdown-menu dd_first">
								<li><a href="sign-up.html">Sign Up</a></li>
								<li><a href="login.html">Login</a></li>
							</ul>
						</li>
						<li class="nav-item dropdown drop_single ">
							<a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" href="javascript:void(0)" data-login>My Account</a>
							<ul class="dropdown-menu dd_first">
								<li><a href="account.html">My Account</a></li>
								<li><a href="change-pass.html">Change Password</a></li>
								<li><a href="address-book.html">Address Book</a></li>
								<li><a href="view-cart.html">List Cart</a></li>
								<li><a href="whistlist.html">Whist List</a></li>
								<li><a href="order-history.html">Order History</a></li>
								<li><a href="rewards-point.html">Rewards Points</a></li>
								<li><a href="transactions.html">Transaction</a></li>
								<li><a href="logout.php">Logout</a></li>
							</ul>
						</li>
						<!-- header search -->
						<li class="nav-item">
							<a href="#" class="btn-search nav-link"><i class="fa fa-search"></i></a>
							<form  class="search_form">
								<input type="text" name="search" placeholder="Search anything..">
								<button class="btn btn-primary btn-small" type="submit">Search</button>
							</form>
						</li>
					</ul>
				</div>
				<!-- header search ends-->
			</nav><!-- NAVBAR ENDS-->
		</div>
	</header>
	<!--/header-->

<div class="main-wrapper pages">
	<!-- BREDCRUMB -->
	<section class="bredcrumb" id="bredcrumb">
		<div class="bg-image text-center" style="background-image: url('img/1920x500.jpg');">
			<h1>Product Detail</h1>
			<ul>
				<li>Home</li>
				<li><a href="javascript:void(0)">Product Detail</a></li>
			</ul>
		</div>
	</section>

	<section class="project-details" id="product-detail">
		<div class="container">
			<div class="row">
				<div class="col-md-5">
					<div id="carousel-example-two" class="carousel slide" data-ride="carousel">
						<ol class="carousel-indicators right_indicators">
							<li data-target="#carousel-example-two" data-slide-to="0" class="active"></li>
							<li data-target="#carousel-example-two" data-slide-to="1"></li>
							<li data-target="#carousel-example-two" data-slide-to="2"></li>
						</ol>
						<div class="carousel-inner" role="listbox">
							<div class="carousel-item active">
								<img src="http://placehold.it/825x400" alt="First slide" data-qw-image="">
							</div>
							<div class="carousel-item">
								<img src="http://placehold.it/825x400" alt="Second slide">
							</div>
							<div class="carousel-item">
								<img src="http://placehold.it/825x400" alt="Third slide">
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-7">
					<div class="bg-image">
						<div class="project_specification">
							<h2 class="text-primary" data-qw-title="">Example Product</h2>
							<i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i> 3 Review
							<div class="row">
								<div class="col-12 size" data-qw-price="">$45</div>
							</div>
							<div class="row">
								<div class="col-12 ">
									Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur eget leo at velit imperdiet varius. In eu ipsum vitae velit congue iaculis vitae at risus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas vitae vehicula enim. Sed quis ante quis eros maximus dignissim a eu mi. Proin varius arcu metus.
								</div>
							</div>
							<div class="row">
												<div class="col-md-2 col-lg-12">
                                                    <button class="btn btn-default btn-primary bold" data-wish="">
                                                    <i class="fa fa-heart-o"></i> <span> Save To Favorite</span></button>
                                                    <!-- Add Stock
                                                    <input data-stock type="number" name="quantity" min="1" max="100" style="
                                                      margin-right:1em;
                                                  "> -->
                                                    <button data-add="" class="btn btn-default btn-primary bold">
                                                        <i class="fa fa-shopping-cart ui-droppable"></i>Add To Cart</button>
                                                    <a href="view-cart.html">
                                                        <button class="btn btn-default btn-primary bold">View Cart</button>
                                                    </a>
                                                </div>
							</div>
							
						</div>
					</div>
				</div>
			</div>
			<div class="row top">
				<div class="col-md-12">
					<ul class="nav nav-tabs" role="tablist">
						<li class="nav-item">
							<a class="nav-link active" data-toggle="tab" href="#des" role="tab">Description</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" data-toggle="tab" href="#speci" role="tab">Specification</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" data-toggle="tab" href="#review" role="tab">Reviews (<span data-count-review>0</span>)</a>
						</li>
					</ul>

					<!-- Tab panes -->
					<div class="tab-content">
						<div class="tab-pane active" id="des" role="tabpanel" data-qw-description="">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptatibus, alias veniam. Beatae nisi illum explicabo minima, voluptatem earum alias dolores, laboriosam vitae hic et ducimus optio dicta quasi assumenda necessitatibus, quas rerum enim qui, ab. Magni id omnis tenetur, nulla, error expedita delectus saepe possimus nam fugiat praesentium voluptatem autem!</div>
						<div class="tab-pane" id="speci" role="tabpanel">
						<table class="table table-striped">
							<tbody>
								<tr>
									<td><b>Example</b></td>
									<td>Example</td>
								</tr>
								<tr>
									<td><b>Example</b></td>
									<td>Example</td>
								</tr>
								<tr>
									<td><b>Example</b></td>
									<td>Example</td>
								</tr>
								<tr>
									<td><b>Example</b></td>
									<td>Example</td>
								</tr>
								<tr>
									<td><b>Example</b></td>
									<td>Example</td>
								</tr>
							</tbody>
						</table>
						</div>
									<style>
                                            #qw-add-review .br-wrapper {
                                                margin-left: 4em;
                                                margin-top: -1.4em;
                                            }
                                            #qw-view-review [data-default-review] {
                                                display: none;
                                            }
                                            #qw-view-review .btn-group:last-child {
                                                float: right;
                                            }
                                            #qw-view-review .btn-group [data-delete-review]:hover {
                                                background: red;
                                            }
                                            #qw-view-review .btn-group [data-edit-review]:hover {
                                                background: #337ab7;
                                            }
                                            #qw-view-review [data-save-group] {
                                                display: none;
                                            }
                                            #qw-view-review [contenteditable="true"] {
                                                border: 1px solid #00BCD4
                                            }
                                            [data-default-review]{
                                                display: none;
                                            }
                                            [data-save-group] {
                                                display: none;
                                            }

                                    </style>
						<div class="tab-pane active" id="review" role="tabpanel">
							<div class="reviews-list" data-container>
								<div class="media" data-default-review data-item>
                                    <!-- <a class="media-left" href="#">
                                        <img alt="" class="img-circle avatar" src="http://placehold.it/40X40">
                                    </a> -->
                                    <template data-review-id></template>
                                    <div class="media-body" style="border: 1px solid #f2f2f2;background:#fffefe;border-radius: 0.5em;padding: 10px;margin-bottom: 10px;">
                                        <p class="pull-right" style="margin-top: 0px;"><small><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i></small></p>
                                        <h4 class="media-heading" data-name>John Doe <small data-date>2 days ago</small></h4>
                                        <span data-text>At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga.</span>
                                        <br>

                                        <div class="btn-group pull-right" role="group" data-save-group>
                                            <button class="btn btn-primary" data-save-review="">
                                                save
                                            </button>
                                            <button class="btn btn-success" data-cancel-review="">
                                                cancel
                                            </button>
                                        </div>

                                        <div class="btn-group pull-right" role="group">
                                            <button class="btn" data-edit-review>
                                                <span class="fa fa-edit" aria-hidden="true"></span>
                                            </button>
                                            <button class="btn" data-delete-review>
                                                <span class="fa fa-trash" aria-hidden="true"></span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
							</div>
							<div style="border: 1px solid #f2f2f2;background:#fffefe;border-radius: 0.5em;padding: 10px; margin-top: 10px">
								<div class="page-header">
	                                <h4>ADD A <b>REVIEW</b></h4>
	                            </div>
	                            <form method="post" class="well padding-bottom-10" onsubmit="return false;">
	                                <div class="row">
	                                    <div class="form-group col-md-12" style="margin-bottom: 10px;margin-top: 10px;">
	                                        <textarea class="form-control" rows="6" placeholder="Review*" required data-teks-review></textarea>
	                                    </div>

	                                    <div class="form-group col-md-12 text-right">
	                                        <button type="submit" class="btn btn-primary float-right" data-add-button><i class="fa fa-check fa-fw"></i> SUBMIT REVIEW</button>
	                                    </div>
	                                </div>
	                            </form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- FOOTER -->
	<footer class="footer footer-classic bg-dark">
		<div class="container">
			<div class="row">
				<div class="col-md-3">
					<div class="footer-text">
						<a href="#"><img class="footer-logo" src="img/logo.png" alt="footer logo"></a>
						<p>
							Lorem ipsum dolor sit amet consectetur adipisicing elit sed do eiusmod tempor incididunt ut labore et dolore magna aliqua ut enim ad minim veniam quis nostrud exercitation.
						</p>
						<div class="social-icons">
							<a href="#" class="btn btn-social btn-social-o twitter">
								<i class="fa fa-twitter"></i>
							</a>
							<a href="#" class="btn btn-social btn-social-o linkedin">
								<i class="fa fa-linkedin"></i>
							</a>
							<a href="#" class="btn btn-social btn-social-o facebook">
								<i class="fa fa-facebook-f"></i>
							</a>
							<a href="#" class="btn btn-social btn-social-o skype">
								<i class="fa fa-skype"></i>
							</a>
							<a href="#" class="btn btn-social btn-social-o pinterest">
								<i class="fa fa-pinterest-p"></i>
							</a>
						</div>
					</div>
				</div>
				<div class="col-xl-2 col-md-2">
					<div class="links">
						<h3>Links</h3>
						<ul class="">
							<li><a href="#">Home</a></li>
							<li><a href="#">Profile</a></li>
							<li><a href="#">Contact</a></li>
							<li><a href="#">Product</a></li>
							<li><a href="#">Gallery</a></li>
						</ul>
					</div>
				</div>
				<div class="col-md-3">
					<div class="location">
						<h3>Location</h3>
						<ul>
							<li>Excepteur sint occaecat cupidat non proident sunt.</li>
							<li><i class="fa fa-home"></i> Jl. Coblong Timur,</li>
							<li><i class="fa fa-phone"></i> <a href="tel:+62 22 20525693">+62 22 20525693</a></li>
							<li><i class="fa fa-envelope"></i> <a href="mailto.html"> info@example.com </a></li>
						</ul>
					</div>
				</div>
				<div class="col-md-4">
					<div class="instagram">
						<h3>Gallery</h3>
						<ul class="row instagram-image qw-list-item">
							<li class="col-xs-4 col-4"><a href="#"><img src="img/gallery/image-1.jpg" alt="insta"></a></li>
							<li class="col-xs-4 col-4"><a href="#"><img src="img/gallery/image-2.jpg" alt="insta"></a></li>
							<li class="col-xs-4 col-4"><a href="#"><img src="img/gallery/image-3.jpg" alt="insta"></a></li>
							<li class="col-xs-4 col-4"><a href="#"><img src="img/gallery/image-4.jpg" alt="insta"></a></li>
							<li class="col-xs-4 col-4"><a href="#"><img src="img/gallery/image-5.jpg" alt="insta"></a></li>
							<li class="col-xs-4 col-4"><a href="#"><img src="img/gallery/image-6.jpg" alt="insta"></a></li>
							<li class="col-xs-4 col-4 qw-list-default"><a href="#"><img src="img/gallery/image-7.jpg" alt="insta"></a></li>
						</ul>
					</div>
				</div>

				<!-- COPY RIGHT -->
			</div>
			<div class="copyright">
				<hr>
				<div class="row">
					<div class="col-sm-6 offset-sm-3">
						<div class="copyRight_text text-center">
							<p> &copy; 2017 Copyright Web Builder.</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</footer>
</div>


<!-- JAVASCRIPTS -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBbo8AqPhlblo2nbndho2I8zLzr0o9Qs28"></script>
<script src="plugins/jquery/jquery.min.js"></script>
<script src="plugins/jquery/jquery-migrate-3.0.0.min.js"></script>
<script src="plugins/bootstrap/js/tether.min.js"></script>
<script src="plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="plugins/selectbox/jquery.selectbox-0.1.3.min.js"></script>
<script src="plugins/slick/slick.min.js"></script>
<script src="js/Chart.min.js"></script>
<script src="plugins/circle-progress/jquery.appear.js"></script>
<script src="plugins/isotope/isotope.min.js"></script>
<script src="plugins/fancybox/jquery.fancybox.min.js"></script>
<script src="js/waypoints.min.js"></script>
<script src="plugins/counterUp/jquery.counterup.js"></script>
<script src="plugins/smoothscroll/SmoothScroll.js"></script>
<script src="plugins/velocity/velocity.min.js"></script>
<script src="plugins/datepicker/bootstrap-datepicker.min.js"></script>
<script src="plugins/syotimer/jquery.syotimer.min.js"></script>
<script src="js/custom.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-bar-rating/1.2.2/jquery.barrating.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            LoadReviews()
            loadToHTML()
            getCustomerById()
            console.log('[qw-inject.js] Loaded')
        })
        /** 
         * 
         * @returns {number} PID
         */
        function getPIDFromUrl() {
            var urlParams = new URLSearchParams(window.location.search)
            return urlParams.get("pid")
        }
        /**
         * Algoritma
         * -------------------------
         * - Get ClientID and Service ID from HTML>
         * - Use it to Create Request to Get Product
         */
        function getClientServiceID() {
            return $.post('scid.txt')
                .then(res => {
                    return JSON.parse(res)
                })
        }
        function getProduct(cid, sid, pid) {
            return $.post('https://build.web.id/api/product/select', {
                client_id: cid,
                service_id: sid,
                pid: pid
            })
        }
        function getProductAttribut(cid, sid, pid) {
            return $.post('https://build.web.id/api/product/attribute/', {
                client_id: cid,
                service_id: sid,
                product_id: pid
            })
        }
        function getProductImage(cid, sid, pid) {
            return $.post('https://build.web.id/api/product/image/', {
                client_id: cid,
                service_id: sid,
                product_id: pid
            })
        }

        async function getCustomerById() {
          let scid = await getClientServiceID()
              customer_id = await getCustomer()

          if(customer_id){
            return $.post('https://build.web.id/api/customers/getCustomerdatabyId/', {
              client_id: scid.cid,
              service_id: scid.layanan_id,
              customer_id: customer_id
            }).then(res => {
                $('[data-login]').html(res.data.firstname+' <b class="caret"></b>')
                $('[data-account]').hide()
            })
          }else{
            $('[data-login]').hide()
            $('[data-account]').show()
          }
        }

        async function loadToHTML() {
            var
                ssid = await getClientServiceID(),
                cid = window.atob(ssid.cid),
                sid = window.atob(ssid.layanan_id),
                pid = getPIDFromUrl()
                set_setting = await getConfigCurrency(ssid.cid, ssid.layanan_id),
                product = await getProduct(cid, sid, pid)
                spesification = await getProductAttribut(cid, sid, pid)
                //product_spec = spesification.data.Technical.Spesification
                image_arr = await getProductImage(cid, sid, pid)

            if(set_setting.code=='IDR'){
                price = parseInt(product.data.price).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
            }else{
                price = (product.data.price/set_setting.value).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
            }

            $('[data-qw-title]').text(product.data.name)
            $('[data-qw-price]').text(set_setting.symbol_left+' '+price)
            $('[data-qw-description]').html(product.data.description)
            $('[data-qw-image]').attr('src', product.data.image)
            //$('[data-qw-spesification]').html(product_spec)

            image_arr = image_arr.data;
            /*image_arr.forEach(images => {
                let clone = $('[data-image-item]').clone(),
                    modified_clone = clone.removeAttr('data-image-item');
                    
                modified_clone.find('[data-qw-image]').attr('src', images.image)
                $('[data-image-container]').append(modified_clone)
            })*/
        }
    </script>

    <script>
        // Check if this product favoritable
        isThisFavorited().then(res => {
            if (res) {
                $('[data-wish]').find('i').attr('class', 'fa fa-heart')
                $('[data-wish]').find('span').text('Favorited')
            } else {
                $('[data-wish]').find('i').attr('class', 'fa fa-heart-o')
                $('[data-wish]').find('span').text('Save To Favorite')
            }
        })
        // Cart button
        $('[data-add]').click(function (e) {
            saveCart()
        })
        // Favorite Button
        $('[data-wish]').click(function (e) {
            // add to wishlist
            addwishlist().then(res => {
                // if success 
                if (res.status == true) {
                    // change Icon and Text to Favorited
                    $(this).find('i').attr('class', 'fa fa-heart')
                    $(this).find('span').text('Favorited')
                } else {
                    // if respon false remove current favorite
                    removewishlist().then(res => {
                        //change Icon and Text to Save To Favorite
                        $(this).find('i').attr('class', 'fa fa-heart-o')
                        $(this).find('span').text('Save To Favorite')
                    })
                }
            })
        })
        async function saveCart() {
            let
                scid = await getClientServiceID(),
                cid = window.atob(scid.cid),
                sid = window.atob(scid.layanan_id),
                pid = parseInt(getPIDFromUrl()),
                customer_id = await getCustomer()
            
            if(customer_id){
                $.post('https://build.web.id/api/cart/add/', {
                    client_id: cid,
                    service_id: sid,
                    customer_id: customer_id,
                    product_id: pid,
                }, function (res, status) {
                    console.log(res, status)
                    swal("Good job!", "Successfully Add To Cart!", "success")
                }).fail(res => {
                    console.log(res.responseText)
                })
            }else{
                swal("Anda belum login!", "Silahkan login terlebih dahulu!", "info")
                .then((value) => {
                    window.location.href = "login.html";
                });
            }
        }
        async function addwishlist() {
            let
                scid = await getClientServiceID(),
                cid = window.atob(scid.cid),
                sid = window.atob(scid.layanan_id),
                pid = parseInt(getPIDFromUrl()),
                customer_id = await getCustomer()
            return $.post('https://build.web.id/api/wishlist/add/', {
                client_id: cid,
                service_id: sid,
                customer_id: customer_id, // Todo Ganti nanti ya
                product_id: pid,
            }).then(res => {
                return res
            })
        }
        async function removewishlist() {
            let
                scid = await getClientServiceID(),
                cid = window.atob(scid.cid),
                sid = window.atob(scid.layanan_id),
                pid = parseInt(getPIDFromUrl()),
                customer_id = await getCustomer()
            return $.post('https://build.web.id/api/wishlist/remove/', {
                client_id: cid,
                service_id: sid,
                customer_id: customer_id, // Todo Ganti nanti ya
                product_id: pid,
            }).then(res => {
                return res
            })
        }
        async function isThisFavorited() {
            let
                scid = await getClientServiceID(),
                cid = window.atob(scid.cid),
                sid = window.atob(scid.layanan_id),
                pid = parseInt(getPIDFromUrl()),
                customer_id = await getCustomer()
            return $.post('https://build.web.id/api/wishlist/data/', {
                client_id: cid,
                service_id: sid,
                customer_id: customer_id, // Todo Ganti nanti ya
            }).then(res => {
                let found = false
                res.data.forEach(element => {
                    if (element.product_id == pid) {
                        found = true
                    }
                })
                return found
            })
        }
        function getCostumerID() {
            return $.post('getdata.php')
                .then(res => {
                    return res
                })
        }
        // Get Review ========================>
        const getCountReview = async() => {
            let
                scid = await getClientServiceID(),
                cid = window.atob(scid.cid),
                sid = window.atob(scid.layanan_id),
                pid = getPIDFromUrl()
            return $.post('https://build.web.id/api/review/product/', {
                client_id: cid,
                service_id: sid,
                product_id: pid
            }).then(res => res.count)
        }
        // Ambil data dari server
        const getReviews = async() => {
            let
                scid = await getClientServiceID(),
                cid = window.atob(scid.cid),
                sid = window.atob(scid.layanan_id),
                pid = getPIDFromUrl()
            return $.post('https://build.web.id/api/review/product/', {
                client_id: cid,
                service_id: sid,
                product_id: pid
            }).then(res => res.data)
        }
        const DEFAULT_ITEM = 'data-default-review'
        const DEFAULT_ITEM_SELECTOR = '[data-default-review]'
        const CONTAINER = 'data-container'
        const CONTAINER_SELECTOR = '[data-container]'
        async function LoadReviews() {
            const
                reviews = await getReviews(),
                scid = await getClientServiceID(),
                cid = window.atob(scid.cid),
                sid = window.atob(scid.layanan_id),
                pid = getPIDFromUrl(),
                count = await getCountReview(),
                customer_id = await getCustomer()

            default_scid = {
                client_id: cid,
                service_id: sid
            }
            const setting_rating = {
                theme: 'fontawesome-stars',
                readonly: true
            }
            //console.log(reviews);
            //console.log(reviews[0].review_id);
            $(CONTAINER_SELECTOR).children().not(DEFAULT_ITEM_SELECTOR).remove()
            $('[data-count-review]').text(count)
            
            reviews.forEach(review => {
                let
                    cloner = getCloner(),
                    name = review.author,
                    teks = review.text,
                    rating = review.rating,
                    date = review.date_added,
                    id = review.review_id

                cloner.find('[data-name]').text(name)
                cloner.find('[data-date]').text(date)
                cloner.find('[data-text]').html(teks)
                cloner.find('[data-review-id]').text(id)
                cloner.find('.qw-review').barrating(setting_rating)
                cloner.find('.qw-review').barrating('set', rating)
                // Event Listener
                cloner.find('[data-delete-review]').click(e => {
                    let id = cloner.find('[data-review-id]').text()
                    var param_add = Object.assign({}, default_scid);
                    param_add.review_id = id
                    swal({
                            title: "Are you sure?",
                            text: "Once deleted, you will not be able to recover this review!",
                            icon: "warning",
                            buttons: true,
                            dangerMode: true,
                        })
                        .then((willDelete) => {
                            if (willDelete) {
                                $.post('https://build.web.id/api/review/remove/', param_add,
                                    function (res) {
                                        if (res.status) {
                                            swal("Poof! Your imaginary file has been deleted!", {
                                                icon: "success",
                                            })
                                            let currentitem = $(e.target).closest('[data-item]')
                                            currentitem.fadeOut(400)
                                        }
                                    })
                            }
                        })
                })
                var
                    oldtext = "",
                    oldrating = 0
                cloner.find('[data-edit-review]').click(e => {
                    let thisItem = $(e.target).closest('[data-item]')
                    let text = thisItem.find('[data-text]').text()
                    let rating = thisItem.find('.qw-review').val()
                    thisItem.find('[data-text]').attr('contentEditable', true)
                    thisItem.find('.qw-review').barrating('readonly', false)
                    thisItem.find('[data-save-group]').show()
                    thisItem.find('[data-text]').focus()
                    
                    oldtext = text
                    oldrating = rating
                })
                cloner.find('[data-save-review]').click(e => {
                    let thisItem = $(e.target).closest('[data-item]')
                    let
                        text = thisItem.find('[data-text]').text(),
                        rating = thisItem.find('.qw-review').val(),
                        review_id = cloner.find('[data-review-id]').text()
                    let param_save = Object.assign({}, default_scid)
                    param_save.product_id = pid
                    param_save.text = text
                    param_save.rating = rating
                    param_save.customer_id = customer_id
                    param_save.review_id = review_id
                    $.post('https://build.web.id/api/review/update', param_save, function (res) {
                            if (res.status) {
                                thisItem.find('[data-text]').attr('contentEditable', false)
                                thisItem.find('.qw-review').barrating('readonly', true)
                                thisItem.find('[data-save-group]').hide()
                            }
                        })
                        .done((res) => {
                            if (res.status) {
                                swal("Good job!", "Succesfully Update!", "success")
                            }
                        })
                        .error(xhr => console.log(xhr))
                })
                cloner.find('[data-cancel-review]').click(e => {
                    cloner.find('[data-text]').text(oldtext)
                    cloner.find('.qw-review').barrating('set', oldrating)
                    cloner.find('[data-text]').attr('contentEditable', false)
                    cloner.find('.qw-review').barrating('readonly', true)
                    cloner.find('[data-save-group]').hide()
                })
                $(CONTAINER_SELECTOR).append(cloner)
            })
            initilizingReview()
        }
        const getCloner = () => {
            let clone = $(DEFAULT_ITEM_SELECTOR).clone()
            return clone.removeAttr(DEFAULT_ITEM)
        }
        /**
         * Change Normal select tag to Rating Star
         * - type    : Side Effect 
         * - Library : http://antenna.io/demo/jquery-bar-rating/examples/
         **/
        const initilizingReview = () => {
            $('#qw-add-review-star').barrating({
                theme: 'fontawesome-stars'
            })
        }
        // Add Review ========================>
        $('[data-add-button]').click(e => {
            addReview()
        })

        async function addReview() {
            let
                scid = await getClientServiceID(),
                cid = window.atob(scid.cid),
                sid = window.atob(scid.layanan_id),
                pid = getPIDFromUrl(),
                customer_id = await getCustomer(),
                teks = $('[data-teks-review]').val(),
                rating = $('#qw-add-review-star').val()
            
            if(customer_id){
                let name = await getNameCostumer()
                $.post('https://build.web.id/api/review/add/', {
                    client_id: cid,
                    service_id: sid,
                    customer_id: customer_id,
                    product_id: pid,
                    author: name,
                    text: teks,
                    rating: rating,
                }, res => {
                    if (res.status) {
                        //swal("Good job!", "Review Succesfully Added!", "success")
                        $('[data-teks-review]').val("")
                        $('#qw-add-review-star').barrating('set', 1)
                        LoadReviews()
                    }
                    //console.log(res)
                })
            }else{
                swal("Anda belum login!", "Silahkan login terlebih dahulu!", "info")
                .then((value) => {
                    window.location.href = "login.html";
                });
            }
            
        }
        async function getNameCostumer(id) {
            let scid = await getClientServiceID(),
                customer_id = await getCustomer()
            return $.post('https://build.web.id/api/customers/getCustomerdatabyId/', {
                client_id: scid.cid,
                service_id: scid.layanan_id,
                customer_id: customer_id,
            }).then(res => {
                //console.log(res)
                return res.data.firstname
            })
        }

        function getCustomer(){
            return $.post('getdata.php').then(function(customer_id){
                return customer_id
            })
        }

        function getConfigCurrency(cid, sid){
            return $.post('https://build.web.id/api/setting/getLocalSetting/', {
                client_id: cid,
                service_id: sid
            }).then(res => {
                return res.data.config_currency
            })
        }
    </script>
</body>

</html>